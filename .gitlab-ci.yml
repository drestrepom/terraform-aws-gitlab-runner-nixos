# GitLab CI configuration for NixOS Flake
stages:
  - test

# Test the hello-world package (builds if needed)
test-hello-world:
  stage: test
  tags:
    - nixos
    - arm64
    - shell
  script:
    - echo "ğŸ§ª Testing hello-world package..."
    - echo "ğŸƒ Running hello-world (builds if needed):"
    - nix develop --command nix run .#hello-world --extra-experimental-features 'nix-command flakes'
    - echo "âœ… Test completed successfully!"

# Show flake information
show-flake:
  stage: test
  tags:
    - nixos
    - arm64
    - shell
  script:
    - echo "ğŸ“‹ Flake information:"
    - nix develop --command nix flake show --extra-experimental-features 'nix-command flakes'
    - echo "ğŸ” Available packages (aarch64-linux):"
    - nix develop --command nix flake show --json --extra-experimental-features 'nix-command flakes' | jq '.packages."aarch64-linux"'
